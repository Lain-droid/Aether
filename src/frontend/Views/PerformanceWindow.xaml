<Window x:Class="AetherVisor.Frontend.Views.PerformanceWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:AetherVisor.Frontend.Views"
        Title="Performance Monitor - Aether" Width="1200" Height="800" WindowStartupLocation="CenterOwner"
        Background="#1E1E1E" Foreground="#D4D4D4">

    <Window.Resources>
        <!-- Styles -->
        <Style x:Key="MetricCardStyle" TargetType="Border">
            <Setter Property="Background" Value="#252526"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="8"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#464647"/>
        </Style>

        <Style x:Key="HeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#D4D4D4"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>

        <Style x:Key="MetricValueStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#007ACC"/>
        </Style>

        <Style x:Key="MetricLabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#CCCCCC"/>
            <Setter Property="Margin" Value="0,4,0,0"/>
        </Style>

        <!-- Data Templates -->
        <DataTemplate x:Key="MetricTemplate">
            <Border Style="{StaticResource MetricCardStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="{Binding Name}" Style="{StaticResource MetricLabelStyle}"/>
                    <TextBlock Grid.Row="1" Text="{Binding FormattedValue}" Style="{StaticResource MetricValueStyle}"/>
                    <TextBlock Grid.Row="2" Text="{Binding LastUpdated, StringFormat='Updated: {0:HH:mm:ss}'}" 
                               FontSize="10" Foreground="#858585" Margin="0,4,0,0"/>
                </Grid>
            </Border>
        </DataTemplate>

        <DataTemplate x:Key="AlertTemplate">
            <Border Background="#2D2D30" Margin="2" Padding="8" CornerRadius="2">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Severity Indicator -->
                    <Border Grid.Column="0" Width="4" Background="{Binding SeverityColor}" 
                            CornerRadius="2" Margin="0,0,8,0"/>

                    <!-- Alert Content -->
                    <StackPanel Grid.Column="1">
                        <TextBlock Text="{Binding Title}" FontWeight="Bold" FontSize="12"/>
                        <TextBlock Text="{Binding Message}" FontSize="11" Foreground="#CCCCCC" 
                                   TextWrapping="Wrap" Margin="0,2,0,0"/>
                    </StackPanel>

                    <!-- Timestamp -->
                    <TextBlock Grid.Column="2" Text="{Binding TimestampFormatted}" 
                               FontSize="10" Foreground="#858585" VerticalAlignment="Top"/>
                </Grid>
            </Border>
        </DataTemplate>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#2D2D30" Padding="16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <TextBlock Text="Performance Monitor" FontSize="20" FontWeight="Bold"/>
                    <TextBlock Text="{Binding Status}" Foreground="#CCCCCC" Margin="0,4,0,0"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button x:Name="StartStopButton" Content="{Binding ButtonText}" Width="100" Margin="8,0"
                            Click="StartStopButton_Click" 
                            Background="#007ACC" Foreground="White" BorderThickness="0" Padding="8,4"/>
                    <Button Content="Generate Report" Width="120" Margin="8,0"
                            Click="GenerateReport_Click"
                            Background="#404040" Foreground="White" BorderThickness="0" Padding="8,4"/>
                    <Button Content="Export Data" Width="100" Margin="8,0"
                            Click="ExportData_Click"
                            Background="#404040" Foreground="White" BorderThickness="0" Padding="8,4"/>
                    <Button Content="Clear History" Width="100" Margin="8,0"
                            Click="ClearHistory_Click"
                            Background="#D13438" Foreground="White" BorderThickness="0" Padding="8,4"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <TabControl Background="Transparent" BorderThickness="0">
                <TabControl.Resources>
                    <Style TargetType="TabItem">
                        <Setter Property="Background" Value="#2D2D30"/>
                        <Setter Property="Foreground" Value="#D4D4D4"/>
                        <Setter Property="Padding" Value="16,8"/>
                        <Setter Property="Margin" Value="2,0"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#007ACC"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </TabControl.Resources>

                <!-- Real-time Metrics Tab -->
                <TabItem Header="Real-time Metrics">
                    <Grid Margin="16">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- System Metrics -->
                        <TextBlock Grid.Row="0" Text="System Metrics" Style="{StaticResource HeaderStyle}"/>
                        
                        <Grid Grid.Row="1" Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- CPU Usage Card -->
                            <Border Grid.Column="0" Style="{StaticResource MetricCardStyle}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Row="0" Text="CPU Usage" Style="{StaticResource MetricLabelStyle}"/>
                                    <TextBlock Grid.Row="1" Text="{Binding CpuUsage, StringFormat='{}{0:F1}%'}" 
                                               Style="{StaticResource MetricValueStyle}"/>
                                    <ProgressBar Grid.Row="2" Value="{Binding CpuUsage}" Maximum="100" 
                                                 Height="4" Margin="0,8,0,0" Background="#404040" 
                                                 Foreground="#007ACC"/>
                                </Grid>
                            </Border>

                            <!-- Memory Usage Card -->
                            <Border Grid.Column="1" Style="{StaticResource MetricCardStyle}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Row="0" Text="Memory Usage" Style="{StaticResource MetricLabelStyle}"/>
                                    <TextBlock Grid.Row="1" Text="{Binding MemoryUsage, Converter={StaticResource BytesToMBConverter}}" 
                                               Style="{StaticResource MetricValueStyle}"/>
                                    <ProgressBar Grid.Row="2" Value="{Binding MemoryUsagePercentage}" Maximum="100" 
                                                 Height="4" Margin="0,8,0,0" Background="#404040" 
                                                 Foreground="#FFCC02"/>
                                </Grid>
                            </Border>

                            <!-- Disk Usage Card -->
                            <Border Grid.Column="2" Style="{StaticResource MetricCardStyle}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Row="0" Text="Disk Usage" Style="{StaticResource MetricLabelStyle}"/>
                                    <TextBlock Grid.Row="1" Text="{Binding DiskUsage, StringFormat='{}{0:F1}%'}" 
                                               Style="{StaticResource MetricValueStyle}"/>
                                    <ProgressBar Grid.Row="2" Value="{Binding DiskUsage}" Maximum="100" 
                                                 Height="4" Margin="0,8,0,0" Background="#404040" 
                                                 Foreground="#CE9178"/>
                                </Grid>
                            </Border>

                            <!-- Network Activity Card -->
                            <Border Grid.Column="3" Style="{StaticResource MetricCardStyle}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Row="0" Text="Network" Style="{StaticResource MetricLabelStyle}"/>
                                    <StackPanel Grid.Row="1">
                                        <TextBlock Text="{Binding NetworkSent, Converter={StaticResource BytesConverter}, StringFormat='↑ {0}'}" 
                                                   Foreground="#6A9955" FontSize="12"/>
                                        <TextBlock Text="{Binding NetworkReceived, Converter={StaticResource BytesConverter}, StringFormat='↓ {0}'}" 
                                                   Foreground="#007ACC" FontSize="12"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </Grid>

                        <!-- Application Metrics -->
                        <Grid Grid.Row="2">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Text="Application Metrics" Style="{StaticResource HeaderStyle}"/>
                            
                            <ItemsControl Grid.Row="1" ItemsSource="{Binding ApplicationMetrics}" 
                                          ItemTemplate="{StaticResource MetricTemplate}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                            </ItemsControl>
                        </Grid>
                    </Grid>
                </TabItem>

                <!-- Charts Tab -->
                <TabItem Header="Performance Charts">
                    <Grid Margin="16">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- CPU Chart -->
                        <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource MetricCardStyle}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Text="CPU Usage History" Style="{StaticResource HeaderStyle}"/>
                                
                                <!-- Chart placeholder - would use a charting library in real implementation -->
                                <Border Grid.Row="1" Background="#1A1A1A" CornerRadius="2">
                                    <TextBlock Text="CPU Chart" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                               Foreground="#858585"/>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Memory Chart -->
                        <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource MetricCardStyle}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Text="Memory Usage History" Style="{StaticResource HeaderStyle}"/>
                                
                                <Border Grid.Row="1" Background="#1A1A1A" CornerRadius="2">
                                    <TextBlock Text="Memory Chart" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                               Foreground="#858585"/>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Network Chart -->
                        <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource MetricCardStyle}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Text="Network Activity" Style="{StaticResource HeaderStyle}"/>
                                
                                <Border Grid.Row="1" Background="#1A1A1A" CornerRadius="2">
                                    <TextBlock Text="Network Chart" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                               Foreground="#858585"/>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Disk Chart -->
                        <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource MetricCardStyle}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Text="Disk Activity" Style="{StaticResource HeaderStyle}"/>
                                
                                <Border Grid.Row="1" Background="#1A1A1A" CornerRadius="2">
                                    <TextBlock Text="Disk Chart" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                               Foreground="#858585"/>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>
                </TabItem>

                <!-- Alerts Tab -->
                <TabItem Header="Alerts">
                    <Grid Margin="16">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="Performance Alerts" Style="{StaticResource HeaderStyle}"/>
                            
                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <Button Content="Clear All" Width="80" Margin="8,0"
                                        Click="ClearAlerts_Click"
                                        Background="#D13438" Foreground="White" BorderThickness="0" Padding="8,4"/>
                                <ComboBox x:Name="AlertFilterComboBox" Width="120" Margin="8,0"
                                          Background="#3C3C3C" Foreground="#D4D4D4" BorderBrush="#464647"
                                          SelectionChanged="AlertFilter_SelectionChanged">
                                    <ComboBoxItem Content="All Alerts" IsSelected="True"/>
                                    <ComboBoxItem Content="Critical"/>
                                    <ComboBoxItem Content="Error"/>
                                    <ComboBoxItem Content="Warning"/>
                                    <ComboBoxItem Content="Info"/>
                                </ComboBox>
                            </StackPanel>
                        </Grid>

                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                            <ItemsControl x:Name="AlertsList" ItemsSource="{Binding Alerts}" 
                                          ItemTemplate="{StaticResource AlertTemplate}"/>
                        </ScrollViewer>
                    </Grid>
                </TabItem>

                <!-- System Info Tab -->
                <TabItem Header="System Info">
                    <Grid Margin="16">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Text="System Information" Style="{StaticResource HeaderStyle}"/>
                        
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                            <StackPanel>
                                <!-- System Overview -->
                                <Border Style="{StaticResource MetricCardStyle}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Operating System:" Margin="0,4"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding SystemInfo.OperatingSystem}" Margin="0,4"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Processor:" Margin="0,4"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding SystemInfo.ProcessorName}" Margin="0,4"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Total Memory:" Margin="0,4"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SystemInfo.FormattedTotalMemory}" Margin="0,4"/>

                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Available Memory:" Margin="0,4"/>
                                        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SystemInfo.FormattedAvailableMemory}" Margin="0,4"/>

                                        <TextBlock Grid.Row="4" Grid.Column="0" Text="System Uptime:" Margin="0,4"/>
                                        <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding SystemInfo.SystemUptime}" Margin="0,4"/>

                                        <TextBlock Grid.Row="5" Grid.Column="0" Text="Last Boot:" Margin="0,4"/>
                                        <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding SystemInfo.LastBootTime}" Margin="0,4"/>
                                    </Grid>
                                </Border>

                                <!-- Process Information -->
                                <Border Style="{StaticResource MetricCardStyle}">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Text="Process Information" 
                                                   FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                        
                                        <Grid Grid.Row="1">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="200"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Process ID:" Margin="0,4"/>
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding ProcessInfo.ProcessId}" Margin="0,4"/>

                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Working Set:" Margin="0,4"/>
                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding ProcessInfo.FormattedWorkingSet}" Margin="0,4"/>

                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Private Memory:" Margin="0,4"/>
                                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding ProcessInfo.FormattedPrivateMemory}" Margin="0,4"/>

                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Thread Count:" Margin="0,4"/>
                                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding ProcessInfo.ThreadCount}" Margin="0,4"/>

                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Run Time:" Margin="0,4"/>
                                            <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding ProcessInfo.RunTime}" Margin="0,4"/>
                                        </Grid>
                                    </Grid>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                </TabItem>
            </TabControl>
        </Grid>

        <!-- Status Bar -->
        <Border Grid.Row="2" Background="#007ACC" Padding="16,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="{Binding StatusMessage}" Foreground="White"/>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="Monitoring:" Foreground="White" Margin="0,0,4,0"/>
                    <TextBlock Text="{Binding Status}" Foreground="White" FontWeight="Bold" Margin="0,0,16,0"/>
                    
                    <TextBlock Text="Data Points:" Foreground="White" Margin="0,0,4,0"/>
                    <TextBlock Text="{Binding CpuHistory.Count}" Foreground="White" FontWeight="Bold" Margin="0,0,16,0"/>
                    
                    <TextBlock Text="Alerts:" Foreground="White" Margin="0,0,4,0"/>
                    <TextBlock Text="{Binding Alerts.Count}" Foreground="White" FontWeight="Bold"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>